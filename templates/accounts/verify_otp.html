{% extends 'base/base.html' %}

{% block content %}
<section class="relative min-h-screen flex items-center justify-center py-16 bg-gradient-to-br from-brand-900 via-brand-800 to-brand-900 theme-light:from-cream-50 theme-light:via-cream-100 theme-light:to-cream-50 overflow-hidden">
	<div class="absolute inset-0 opacity-60 bg-[radial-gradient(circle_at_10%_20%,rgba(183,110,121,0.25),transparent_35%),radial-gradient(circle_at_90%_0%,rgba(17,100,102,0.35),transparent_30%),radial-gradient(circle_at_50%_90%,rgba(183,110,121,0.25),transparent_35%)]"></div>
	<div class="absolute inset-0 backdrop-blur-2xl"></div>

	<div class="relative w-full max-w-md mx-auto px-6">
		<!-- OTP Verification Card -->
		<div class="glass-dark rounded-2xl border border-accent-400/30 theme-light:bg-white theme-light:border-brand-200 shadow-2xl shadow-brand-900/40 theme-light:shadow-brand-500/20">
			<div class="p-8 md:p-10 space-y-8">
				<div class="space-y-2 text-center">
					<div class="flex justify-center mb-3">
						<div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-accent-400 to-accent-600 text-white flex items-center justify-center text-2xl font-display font-bold shadow-lg shadow-accent-700/30 theme-light:shadow-accent-500/30">
							<i class="fas fa-envelope-open-text"></i>
						</div>
					</div>
					<h2 class="font-display text-2xl font-bold text-white theme-light:text-brand-900">Verify Your Email</h2>
					<p class="text-white theme-light:text-brand-700 text-sm">Enter the 6-digit code we sent to your email</p>
				</div>

				{% if messages %}
					<div class="space-y-2">
						{% for message in messages %}
							<div class="px-4 py-3 rounded-lg {% if message.tags == 'success' %}bg-green-500/15 border border-green-500/30 text-green-100 theme-light:text-green-900 theme-light:bg-green-50{% else %}bg-red-500/15 border border-red-500/30 text-red-100 theme-light:text-red-900 theme-light:bg-red-50{% endif %}">
								{{ message }}
							</div>
						{% endfor %}
					</div>
				{% endif %}

				<form method="post" class="space-y-6">
					{% csrf_token %}

					<div class="space-y-2">
						<label for="otp" class="text-sm font-semibold text-white theme-light:text-brand-900">OTP Code</label>
						<input id="otp" name="otp" type="text" required maxlength="6" pattern="[0-9]{6}"
							class="w-full px-4 py-3 rounded-xl bg-brand-800/50 dark:bg-brand-800/40 border border-accent-400/30 text-white theme-light:text-brand-900 theme-light:bg-cream-50 theme-light:border-brand-300 placeholder-white/50 theme-light:placeholder-brand-400 focus:outline-none focus:border-accent-400 focus:ring-2 focus:ring-accent-400/50 transition-all text-center text-2xl tracking-widest font-bold"
							placeholder="000000"
							autocomplete="off" />
						<p class="text-xs text-white theme-light:text-brand-600">Enter the 6-digit code sent to your email</p>
					</div>

					<button type="submit" class="w-full py-3.5 rounded-xl bg-gradient-to-r from-accent-500 to-accent-600 text-white font-semibold text-base shadow-lg shadow-accent-700/30 hover:-translate-y-0.5 transition-all duration-300">
						Verify & Create Account
					</button>
				</form>

				<!-- Resend OTP -->
				<div class="text-center">
					<p class="text-sm text-white theme-light:text-brand-700">
						Didn't receive the code? 
						<a href="{% url 'accounts:resend_otp' %}" class="text-accent-300 theme-light:text-accent-600 font-semibold hover:underline">Resend OTP</a>
					</p>
				</div>

				<!-- Back to Register -->
				<div class="text-center pt-4 border-t border-accent-400/20">
					<a href="{% url 'accounts:register' %}" class="text-sm text-white theme-light:text-brand-700 hover:text-accent-300 transition-all">
						<i class="fas fa-arrow-left mr-2"></i>Back to Registration
					</a>
				</div>
			</div>
		</div>

		<!-- Security Notice -->
		<div class="mt-6 p-4 rounded-lg bg-accent-500/10 border border-accent-400/20">
			<div class="flex items-start space-x-3">
				<i class="fas fa-shield-alt text-accent-300 text-lg mt-1"></i>
				<div>
					<p class="text-sm text-white theme-light:text-brand-700">
						<span class="font-semibold">Security Notice:</span> Your OTP code will expire in 10 minutes. Never share this code with anyone.
					</p>
				</div>
			</div>
		</div>
	</div>
</section>

<script>
	// Auto-focus on OTP input
	document.getElementById('otp').focus();

	// Auto-submit when 6 digits are entered
	document.getElementById('otp').addEventListener('input', function(e) {
		if (e.target.value.length === 6) {
			// Optional: auto-submit after a brief delay
			setTimeout(() => {
				if (e.target.value.length === 6) {
					// You can uncomment this to enable auto-submit
					// e.target.form.submit();
				}
			}, 500);
		}
	});

	// Only allow numbers
	document.getElementById('otp').addEventListener('keypress', function(e) {
		if (!/[0-9]/.test(e.key)) {
			e.preventDefault();
		}
	});
</script>
{% endblock %}
